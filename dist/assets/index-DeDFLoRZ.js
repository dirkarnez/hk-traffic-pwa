(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(e){if(e.ep)return;e.ep=!0;const s=r(e);fetch(e.href,s)}})();function c(n,t){const r=n.getTime(),a=t.getTime(),e=Math.abs(a-r),s=Math.floor(e/1e3),u=Math.floor(s/60),i=s%60;return{minutes:u,seconds:i}}const h=n=>fetch(n,{method:"GET",cache:"no-cache"}).then(t=>t.json());class m{kmbDestTC;constructor(t){this.kmbDestTC=t}filter(t){return!!t.eta&&(this.kmbDestTC==null||t.dest_tc==this.kmbDestTC)}deserialize(t){return{company:"KMB",eta:new Date(Date.parse(t.eta)),dataTime:new Date(Date.parse(t.data_timestamp))}}}class p{citybusDestTC;constructor(t){this.citybusDestTC=t}filter(t){return!!t.eta&&(this.citybusDestTC==null||t.dest_tc==this.citybusDestTC)}deserialize(t){return{company:"Citybus",eta:new Date(Date.parse(t.eta)),dataTime:new Date(Date.parse(t.data_timestamp))}}}const o=(n,t)=>h(n).then(r=>r.data.filter(a=>t.filter(a)).map(a=>t.deserialize(a))),d=(n,t,r,a)=>Promise.all([Array.isArray(n)?Promise.all(n.map(e=>o(e,new m(t)))):Promise.resolve(null),Array.isArray(r)?Promise.all(r.map(e=>o(e,new p(a)))):Promise.resolve(null)]).then(e=>e.filter(s=>!!s).reduce((s,u)=>[...s,...u.reduce((i,l)=>[...i,...l],[])],[])),b=[{name:"116 - HH to Tak Oi",kmbURL:["https://data.etabus.gov.hk/v1/transport/kmb/eta/11B2034DDF30617A/116/1"],kmbDestTC:"慈雲山(中)",citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/001475/116"],citybusDestTC:"慈雲山(中)",otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/116-1-quarry-bay-(yau-man-street)-tsz-wan-shan-(central)/001475%2C12"}]},{name:"3D - Tak Oi to KLB",kmbURL:["https://data.etabus.gov.hk/v1/transport/kmb/eta/A4C9136D18013389/3D/1","https://data.etabus.gov.hk/v1/transport/kmb/eta/A4C9136D18013389/3D/3"],kmbDestTC:"觀塘(裕民坊)",citybusURL:null,citybusDestTC:null,otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/3d-1-tsz-wan-shan-(central)-kwun-tong-(yue-man-square)/8C09B3648DCDAF3C%2C10"},{name:"hkbus.app",url:"https://hkbus.app/zh/route/3d-3-ching-hong-house-kwun-tong-(yue-man-square)/8C09B3648DCDAF3C%2C8"}]},{name:"793 - 新蒲崗 Mikiki to 將軍澳 先進製造業中心, 駿光街",kmbURL:null,kmbDestTC:null,citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/001573/793"],citybusDestTC:"將軍澳工業邨",otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/793-1-so-uk-tseung-kwan-o-industrial-estate/001573%2C19"}]},{name:"793 - 調景嶺 to 將軍澳 先進製造業中心, 駿光街",kmbURL:null,kmbDestTC:null,citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/002917/793"],citybusDestTC:null,otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/793-1-so-uk-tseung-kwan-o-industrial-estate/002917%2C26"}]},{name:"796X - 調景嶺 to 將軍澳 先進製造業中心, 駿光街",kmbURL:null,kmbDestTC:null,citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/002917/796X"],citybusDestTC:"將軍澳工業邨",otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/796x-2-tsim-sha-tsui-east-tseung-kwan-o-industrial-estate"}]},{name:"796X - 將軍澳 先進製造業中心, 駿光街 to HH",kmbURL:null,kmbDestTC:null,citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/002927/796X"],citybusDestTC:null,otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/796x-1-tseung-kwan-o-industrial-estate-tsim-sha-tsui-east/002927%2C4"},{name:"hkbus.app",url:"https://hkbus.app/zh/route/796x-1-tseung-kwan-o-industrial-estate-%EF%BC%8F-tseung-kwan-o-station-tsim-sha-tsui-east/002927%2C4"}]},{name:"796X - 將軍澳 日出康城領都, 環保大道 to HH",kmbURL:null,kmbDestTC:null,citybusURL:["https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/002928/796X"],citybusDestTC:null,otherPlatforms:[{name:"hkbus.app",url:"https://hkbus.app/zh/route/796x-1-tseung-kwan-o-industrial-estate-tsim-sha-tsui-east/002928%2C5"},{name:"hkbus.app",url:"https://hkbus.app/zh/route/796x-1-tseung-kwan-o-industrial-estate-%EF%BC%8F-tseung-kwan-o-station-tsim-sha-tsui-east/002928%2C5"}]}];(n=>{n&&Promise.all(b.map(t=>{const r=document.createElement("details"),a=document.createElement("summary");r.open=!0,a.innerHTML=`<div style="display: contents">${t.name} ${[...Array.isArray(t.kmbURL)?t.kmbURL:[],...Array.isArray(t.citybusURL)?t.citybusURL:[]].map((s,u)=>`<a href="${s}" target="_blank">API ${u}</a>`).join("&nbsp;")} ${t.otherPlatforms.map(({url:s,name:u})=>`<a href="${s}" target="_blank">${u}</a>`).join("&nbsp;")}</div>`;const e=document.createElement("ol");return r.appendChild(e),r.appendChild(a),n.appendChild(r),d(t.kmbURL,t.kmbDestTC,t.citybusURL,t.citybusDestTC).then(s=>({routeName:t.name,vehicles:s,dom:{detailsElement:r,summaryElement:a,orderListElement:e},otherPlatforms:t.otherPlatforms}))})).then(t=>{t.forEach(r=>{r.vehicles.sort((a,e)=>a.eta.getTime()-e.eta.getTime()).forEach(a=>{const e=document.createElement("li"),s=c(a.eta,a.dataTime);e.innerText=`[${s.minutes} mins ${s.seconds} secs] ${a.company}`,r.dom.orderListElement.appendChild(e)})})})})(document.querySelector("#app"));
